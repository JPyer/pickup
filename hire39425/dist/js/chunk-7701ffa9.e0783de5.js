(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7701ffa9"],{"0fea":function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o}));var n=a("b775"),i={user:"/user",role:"/api/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree"};function r(e){return Object(n["b"])({url:i.role,method:"get",params:e})}function o(e){return Object(n["b"])({url:i.service,method:"get",params:e})}},"3fdc":function(e,t,a){"use strict";var n=a("909a"),i=a.n(n);i.a},"432b":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("5530"),i=a("5880"),r={computed:Object(n["a"])(Object(n["a"])({},Object(i["mapState"])({layout:function(e){return e.app.layout},navTheme:function(e){return e.app.theme},primaryColor:function(e){return e.app.color},colorWeak:function(e){return e.app.weak},fixedHeader:function(e){return e.app.fixedHeader},fixedSidebar:function(e){return e.app.fixedSidebar},contentWidth:function(e){return e.app.contentWidth},autoHideHeader:function(e){return e.app.autoHideHeader},isMobile:function(e){return e.app.isMobile},sideCollapsed:function(e){return e.app.sideCollapsed},multiTab:function(e){return e.app.multiTab}})),{},{isTopMenu:function(){return"topmenu"===this.layout}}),methods:{isSideMenu:function(){return!this.isTopMenu}}}},"4d03":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("page-header-wrapper",[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:5,sm:16}},[n("a-form-item",{attrs:{label:"设备ID"}},[n("a-input-number",{attrs:{placeholder:""},model:{value:t.queryParam.id,callback:function(e){t.$set(t.queryParam,"id",e)},expression:"queryParam.id"}})],1)],1),n("a-col",{attrs:{md:8,sm:16}},[n("a-form-item",{attrs:{label:"设备名称"}},[n("a-input",{attrs:{placeholder:""},model:{value:t.queryParam.device_name,callback:function(e){t.$set(t.queryParam,"device_name",e)},expression:"queryParam.device_name"}})],1)],1),n("a-col",{attrs:{md:5,sm:7}},[n("a-form-item",{attrs:{label:"使用状态"}},[n("a-select",{attrs:{placeholder:"全部","default-value":""},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}},[n("a-select-option",{attrs:{value:""}},[t._v("全部")]),n("a-select-option",{attrs:{value:"0"}},[t._v("关闭")]),n("a-select-option",{attrs:{value:"1"}},[t._v("运行中")]),n("a-select-option",{attrs:{value:"2"}},[t._v("录音中")]),n("a-select-option",{attrs:{value:"3"}},[t._v("异常")])],1)],1)],1),n("a-col",{attrs:{md:6,sm:16}},[n("a-form-item",{attrs:{label:"分组"}},[n("a-select",{attrs:{placeholder:"全部","default-value":""},model:{value:t.queryParam.group_id,callback:function(e){t.$set(t.queryParam,"group_id",e)},expression:"queryParam.group_id"}},[n("a-select-option",{attrs:{value:""}},[t._v("全部")]),t._l(t.groupOptions,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1),t.advanced?[n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"更新日期"}},[n("a-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入更新日期"},model:{value:t.queryParam.date,callback:function(e){t.$set(t.queryParam,"date",e)},expression:"queryParam.date"}})],1)],1)]:t._e(),n("a-col",{attrs:{md:t.advanced?24:8,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons",style:t.advanced&&{float:"right",overflow:"hidden"}||{}},[n("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[t._v("重置")]),n("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"收起":"展开")+" "),n("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],2)],1)],1),n("div",{staticClass:"table-operator"},[n("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新建")]),n("a-button",{attrs:{type:"info",icon:"search",loading:t.discovery_loading},on:{click:t.handleDiscovery}},[t._v(" 网络查找 ")]),n("a-dropdown",[n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1",on:{click:t.batchOpenAudio}},[n("a-icon",{attrs:{type:"audio"}}),t._v("开启录音")],1),n("a-menu-item",{key:"2",on:{click:t.batchCloseAudio}},[n("a-icon",{attrs:{type:"stop"}}),t._v("停止录音")],1)],1),n("a-button",{staticStyle:{"margin-left":"8px"}},[t._v(" 批量操作 "),n("a-icon",{attrs:{type:"down"}})],1)],1)],1),n("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:t.columns,dataSource:t.data,data:t.loadData,alert:!0,rowSelection:t.rowSelection,showPagination:"auto"},scopedSlots:t._u([{key:"serial",fn:function(e,a,i){return n("span",{},[t._v(" "+t._s(i+1)+" ")])}},{key:"status",fn:function(e){return n("span",{},[n("a-badge",{attrs:{status:t._f("statusTypeFilter")(e),text:t._f("statusFilter")(e)}})],1)}},{key:"description",fn:function(e){return n("span",{},[n("ellipsis",{attrs:{length:4,tooltip:""}},[t._v(t._s(e))])],1)}},{key:"action",fn:function(e,a){return n("span",{},[[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("a-popconfirm",{attrs:{title:2===a.status?"确认关闭录音？":"确认开始录音？",disabled:0===a.status},on:{confirm:function(e){return t.handleAudioRecord(e,a.id)}}},[n("a-button",{ref:"record_btn",attrs:{loading:a.loading,disabled:0===a.status,size:"small",type:2===a.status?"danger":"primary"}},[n("a-icon",{attrs:{type:2===a.status?"stop":"audio"}})],1)],1),n("a-divider",{attrs:{type:"vertical"}}),n("a-dropdown",[n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{attrs:{width:"200px"}},[n("a",{on:{click:function(e){return t.handleEdit(a)}}},[n("a-icon",{attrs:{type:"setting"}}),t._v("设备配置")],1),n("a",{on:{click:function(e){return t.handleAudioSet(a.id)}}},[n("a-icon",{attrs:{type:"audio"}}),t._v("音频参数")],1),n("a",{on:{click:function(e){return t.handleAudioChannelEdit(a.id)}}},[n("a-icon",{attrs:{type:"notification"}}),t._v("音频通道")],1),n("a-popconfirm",{attrs:{title:"警告！是否要删除该设备(运行中请先关闭)？"},on:{confirm:function(e){return t.delete_device(a.id)}}},[n("a",{staticStyle:{color:"red"}},[n("a-icon",{attrs:{type:"delete"}}),t._v("删除设备")],1)])],1)],1),n("a",[t._v("更多"),n("a-icon",{attrs:{type:"down"}})],1)],1)],1)]],2)}}])}),n("device-info-form",{ref:"createModal",attrs:{visible:t.visible,loading:t.confirmLoading,model:t.mdl,options:t.groupOptions},on:{cancel:t.handleCancel,ok:t.handleOk}}),n("discovery-device-advanced-table",{ref:"discoveryAdvancedDeviceModal",attrs:{visible:t.discovery_form_visible,loading:t.discovery_loading,data:t.discovery_device_list},on:{cancel:t.handleDiscoveryCancel}}),n("device-audio-channel-edit-form",{ref:"deviceAudioChannelModal",attrs:{visible:t.channel_visible,loading:t.channelConfirmLoading,model:t.channel_mdl},on:{cancel:t.handleChannelCancel,ok:t.handleChannelOk}}),n("device-audio-set-form",{ref:"deviceAudioSetModal",attrs:{visible:t.audio_set_visible,loading:t.audioSettingConfirmLoading,model:t.audio_set_mdl},on:{cancel:t.handleAudioSettingCancel,ok:t.handleAudioSettingOk}})],1)],1)},i=[],r=(a("7db0"),a("d3b7"),a("5530")),o=a("c1df"),s=a.n(o),d=a("2af9"),l=a("aa98"),c=a("dfe3"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.model&&e.model.id>0?"编辑设备":"添加设备",width:640,visible:e.visible,confirmLoading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"设备ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:0}],expression:"['id', { initialValue: 0 }]"}],attrs:{disabled:""}})],1),a("a-form-item",{attrs:{label:"设备名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["device_name",{rules:[{required:!1,message:"请输入设备名称"}]}],expression:"['device_name', {rules:[{required: false, message: '请输入设备名称'}]}]"}]})],1),a("a-form-item",{attrs:{label:"设备ip"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip_addr",{rules:[{required:!0,message:"请输入设备IP地址：如192.168.X.X"}]}],expression:"['ip_addr',  {rules:[{required: true, message: '请输入设备IP地址：如192.168.X.X'}]}]"}],attrs:{disabled:1===e.model.status||2===e.model.status}})],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"网卡物理地址"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mac_addr",{rules:[{required:!1,message:"请输入网卡物理地址"}]}],expression:"['mac_addr', {rules:[{required: false, message: '请输入网卡物理地址'}]}]"}],attrs:{disabled:""}})],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"子网掩码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["subnet",{rules:[{required:!1,message:"请输入子网掩码"}]}],expression:"['subnet', {rules:[{required: false, message: '请输入子网掩码'}]}]"}]})],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"dns服务器1"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dns_server1",{rules:[{required:!1,message:"请输入dns服务器"}]}],expression:"['dns_server1', {rules:[{required: false, message: '请输入dns服务器'}]}]"}]})],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"dns服务器2"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dns_server2",{rules:[{required:!1,message:"请输入dns服务器"}]}],expression:"['dns_server2', {rules:[{required: false, message: '请输入dns服务器'}]}]"}]})],1),a("a-form-item",{attrs:{label:"所属分组"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["device_group_id",{rules:[{required:!1,message:"请输入所在组"}]}],expression:"['device_group_id', {rules:[{required: false, message: '请输入所在组'}]}]"}]},e._l(e.options,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id,selected:e.model.device_group_id===t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"备注"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{rules:[{required:!1,min:1,message:"请输入至少五个字符的规则描述！"}]}],expression:"['remark', {rules: [{required: false, min: 1, message: '请输入至少五个字符的规则描述！'}]}]"}]})],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"状态"}},[e._v(" "+e._s(e._f("statusFilter")(e.model.status))+" ")]),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.visible,expression:"model && visible"}],attrs:{label:"写入硬件"}},[a("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["writeInDevice",{rules:[],initialValue:0}],expression:"['writeInDevice',{rules: [], initialValue: 0}]"}],attrs:{disabled:0===e.model.status||3===e.model.status}})],1)],1)],1)],1)},m=[],f=(a("4160"),a("88bc")),v=a.n(f),p=["id","device_name","device_group_id","mac_addr","ip_addr","subnet","gateway","dns_server1","dns_server2","security_key","remark","writeInDevice"],h={name:"DeviceInfoForm",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}},options:{type:Array,default:function(){return null}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this)}},filters:{},created:function(){var e=this;p.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(v()(e.model,p))}))}},b=h,g=a("2877"),_=Object(g["a"])(b,u,m,!1,null,null,null),y=_.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"已发现的设备列表",width:820,visible:e.visible,loading:e.loading},on:{cancel:function(){e.$emit("cancel")}}},[a("div",[a("div",{staticClass:"table-operator"},[e.selectedRowKeys.length>0?a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a-icon",{attrs:{type:"plus"}}),e._v("添加")],1),a("a-menu-item",{key:"2"},[a("a-icon",{attrs:{type:"delete"}}),e._v("移除")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"product_id",columns:e.columns,data:e.loadData,rowSelection:e.rowSelection},scopedSlots:e._u([{key:"serial",fn:function(t,n,i){return a("span",{},[e._v(" "+e._s(i+1)+" ")])}},{key:"action",fn:function(t,n){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}})]],2)}}])})],1)])},k=[],O=a("0fea"),x={name:"DiscoveryDeviceTableList",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},data:{type:Object,required:!0}},components:{STable:d["k"]},data:function(){var e=this;return{advanced:!1,queryParam:{},columns:[{title:"#",scopedSlots:{customRender:"serial"}},{title:"产品ID",dataIndex:"product_id"},{title:"设备ID",dataIndex:"device_id"},{title:"设备名称",dataIndex:"device_name"},{title:"ip",dataIndex:"ip_addr"},{title:"固件版本",dataIndex:"fw_version"},{title:"mac地址",dataIndex:"mac_addr",needTotal:!0},{title:"状态",dataIndex:"err_code",needTotal:!0},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){if(e.visible)return Object(l["e"])(Object.assign(t,e.queryParam)).then((function(t){return e.$message.info(t.message),e.loading=!1,t})).catch((function(t){e.$message.error("查找失败:"+t.message),e.loading=!1}))},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},optionAlertShow:!1}},created:function(){Object(O["c"])({t:"test_table"})},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleEdit:function(e){this.$emit("onEdit",e)},handleOk:function(){},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:s()(new Date)}},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(r["a"])({},t),t.editable=!t.editable}}},j=x,S=Object(g["a"])(j,w,k,!1,null,null,null),$=S.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"已发现的设备列表",width:880,visible:e.visible,loading:e.loading,okText:e.okText,cancelText:e.cancelText},on:{ok:e.handleDiscoveryDeviceOk,cancel:function(){e.$emit("cancel")}}},[a("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading},scopedSlots:e._u([e._l(e.table_columns,(function(t,n){return{key:t,fn:function(i,r){return[r.editable?a("a-input",{key:t,staticStyle:{margin:"-5px 0"},attrs:{value:i,placeholder:e.columns[n].title},on:{change:function(a){return e.handleChange(a.target.value,r.key,t)}}}):[e._v(e._s(i))]]}}})),{key:"operation",fn:function(t,n){return[n.editable?[n.isNew?a("span",[a("a",{on:{click:function(t){return e.saveRow(n)}}},[e._v("添加")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(n.key)}}},[a("a",[e._v("删除")])])],1):a("span",[a("a",{on:{click:function(t){return e.saveRow(n)}}},[e._v("保存")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.cancel(n.key)}}},[e._v("取消")])],1)]:a("span",[a("a",{on:{click:function(t){return e.toggle(n.key)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否要移除此行？"},on:{confirm:function(t){return e.remove(n.key)}}},[a("a",[e._v("移除")])])],1)]}}],null,!0)}),a("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{loading:e.memberLoading,type:"dashed",icon:"plus",disabled:e.memberLoading},on:{click:e.newMember}},[e._v(" "+e._s(e.memberLoading?"正在查找":"继续查找")+" ")])],1)},q=[],D=(a("4de4"),a("d81d"),a("b64b"),a("3ca3"),a("159b"),a("ddb0"),a("6b75"));function I(e){if(Array.isArray(e))return Object(D["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("e260");function A(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var F=a("06c5");function L(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e){return I(e)||A(e)||Object(F["a"])(e)||L()}var R=a("5a70"),N=a("432b"),T={name:"DiscoveryDeviceAdvancedForm",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}}},mixins:[N["a"]],components:{FooterToolBar:R["a"],STable:d["k"]},data:function(){var e=this;return{memberLoading:!1,okText:"添加",cancelText:"取消",data:[],columns:[{title:"#",scopedSlots:{customRender:"serial"}},{title:"产品ID",key:"product_id",dataIndex:"product_id"},{title:"设备ID",key:"device_id",dataIndex:"device_id",width:"15%",scopedSlots:{customRender:"device_id"}},{title:"名称",key:"device_name",dataIndex:"device_name",width:"20%",scopedSlots:{customRender:"device_name"}},{title:"ip",key:"ip_addr",dataIndex:"ip_addr",width:"25%"},{title:"固件版本",key:"fw_version",dataIndex:"fw_version",width:"11%"},{title:"mac地址",key:"mac_addr",dataIndex:"mac_addr"},{title:"操作",dataIndex:"operation",width:"20%",scopedSlots:{customRender:"operation"}}],table_columns:["key","product_id","device_id","fw_version","device_name","mac_addr","ip_addr"],loadData:function(t){if(e.visible)return self.discovery_device()},errors:[]}},created:function(){},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},watch:{visible:function(e,t){e&&0===this.data.length&&this.discovery_device()}},methods:{handleSubmit:function(e){e.preventDefault()},discovery_device:function(){var e=this;return this.memberLoading=!0,Object(l["e"])().then((function(t){e.$message.info(t.message),e.memberLoading=!1,e.data=t.data})).catch((function(t){e.$message.error("查找失败:"+t.message),e.memberLoading=!1})),this.data},handleDiscoveryDeviceOk:function(){var e=this;new Promise((function(t,a){Object(l["a"])({dataset:e.data}).then((function(t){200===t.code?(e.$message.info(t.message),e.visible=!1,e.data=[],e.$router.go(0)):e.$message.error(" 添加失败:".concat(t.message)),e.loading=!1})).catch((function(t){e.loading=!1,a(t)}))})).then((function(){}))},newMember:function(){this.memberLoading=!0,this.discovery_device()},remove:function(e){var t=this.data.filter((function(t){return t.key!==e}));this.data=t},saveRow:function(e){if(e.device_id&&e.device_name){var t=this.data.find((function(t){return t.key===e.key}));t.editable=!1,t.isNew=!1}else this.loading=!1,this.$message.error("请填写完整信息。")},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(r["a"])({},t),t.editable=!t.editable},getRowByKey:function(e,t){var a=this.data;return(t||a).find((function(t){return t.key===e}))},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,a){var n=P(this.data),i=n.find((function(e){return t===e.key}));i&&(i[a]=e,this.data=n)},validate:function(){var e=this,t=this.$refs,a=t.repository,n=t.task,i=this.$notification,o=new Promise((function(e,t){a.form.validateFields((function(a,n){a?t(a):e(n)}))})),s=new Promise((function(e,t){n.form.validateFields((function(a,n){a?t(a):e(n)}))}));this.errors=[],Promise.all([o,s]).then((function(e){i["error"]({message:"Received values of form:",description:JSON.stringify(e)})})).catch((function(){var t=Object.assign({},a.form.getFieldsError(),n.form.getFieldsError()),i=Object(r["a"])({},t);e.errorList(i)}))},errorList:function(e){e&&0!==e.length&&(this.errors=Object.keys(e).filter((function(t){return e[t]})).map((function(t){return{key:t,message:e[t][0]}})))},scrollToField:function(e){var t=document.querySelector('label[for="'.concat(e,'"]'));t&&t.scrollIntoView(!0)}}},E=T,M=(a("3fdc"),Object(g["a"])(E,C,q,!1,null,"a6347f6c",null)),K=M.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"音频通道信息编辑",width:640,visible:e.visible,confirmLoading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.model&&e.model.id>0,expression:"model && model.id > 0"}],attrs:{label:"设备ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:0}],expression:"['id', { initialValue: 0 }]"}],attrs:{disabled:""}})],1),a("a-form-item",{attrs:{label:"输出通道数"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["output_channel",{rules:[{required:!1,message:"请输入输出通道数,默认为0"}]}],expression:"['output_channel', {rules:[{required: false, message: '请输入输出通道数,默认为0'}]}]"}]},e._l(e.channelOptions,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"音频采样率"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["audio_sample_rate",{rules:[{required:!0,message:"请输入声道数，默认为16000"}]}],expression:"['audio_sample_rate', {rules:[{required: true, message: '请输入声道数，默认为16000'}]}]"}]},e._l(e.sampleRateOptions,(function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"采样位数"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["audio_sample_bits",{rules:[{required:!0,message:"请输入采样位数,默认为24"}]}],expression:"['audio_sample_bits', {rules:[{required: true, message: '请输入采样位数,默认为24'}]}]"}]})],1),a("a-form-item",{attrs:{label:"重传超时阈值"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["retrans_timeout",{rules:[{required:!0,message:"重传超时阈值，默认为1000"}]}],expression:"['retrans_timeout', {rules:[{required: true, message: '重传超时阈值，默认为1000'}]}]"}]})],1)],1)],1)],1)},V=[],H=["id","output_channel","audio_sample_rate","audio_sample_bits","retrans_timeout"],X={name:"DeviceAudioChannelEditForm",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),channelOptions:[{value:1,name:"单路输出"},{value:8,name:"8路输出:7MIC+1"},{value:9,name:"9路输出:8MIC+1"},{value:17,name:"17路输出:16MIC+1"}],encoderOptions:[{value:1,name:"PCM_S8"},{value:2,name:"PCM_S16LE"},{value:3,name:"PCM_S24LE"},{value:10,name:"OPUS"}],channelsOptions:[{value:1,name:"单声道"},{value:2,name:"双声道"}],sampleRateOptions:[8e3,12e3,16e3],audioBitrateOption:[0,16e3,32e3,48e3]}},created:function(){var e=this;H.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(v()(e.model,H))}))}},z=X,J=Object(g["a"])(z,B,V,!1,null,null,null),W=J.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"音频设置",width:640,visible:e.visible,confirmLoading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"设备ID"}},[e._v(" "+e._s(e.model.id)+" ")]),a("a-form-item",{attrs:{label:"FFT点数"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["fft_points",{rules:[{required:!0,message:"请输入FFT点数"}]}],expression:"['fft_points', {rules:[{required: true, message: '请输入FFT点数'}]}]"}]})],1),a("a-form-item",{attrs:{label:"输出增益"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["output_gain",{rules:[{required:!0,message:"请输入输出增益"}]}],expression:"['output_gain', {rules:[{required: true, message: '请输入输出增益'}]}]"}]})],1),a("a-form-item",{attrs:{label:"麦克风头指向参数"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["mic_direction",{rules:[{required:!0,message:"请输入麦克风头指向参数"}]}],expression:"['mic_direction', {rules:[{required: true, message: '请输入麦克风头指向参数'}]}]"}]})],1),a("a-form-item",{attrs:{label:"状态"}},[e._v(" "+e._s(e._f("statusFilter")(e.model.status))+" ")])],1)],1)],1)},U=[],Q=["id","fft_points","output_gain","mic_direction","status","writeInDevice"],Y={name:"DeviceAudioChannelEditForm",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this)}},created:function(){var e=this;Q.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(v()(e.model,Q))}))}},Z=Y,ee=Object(g["a"])(Z,G,U,!1,null,null,null),te=ee.exports,ae=[{title:"#",scopedSlots:{customRender:"serial"}},{title:"ID",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"名称",dataIndex:"device_name"},{title:"mac",dataIndex:"mac_addr"},{title:"ip",dataIndex:"ip_addr",sorter:!0},{title:"音频",dataIndex:"audio_count",sorter:!0,needTotal:!0,scopedSlots:{customRender:"audio_count"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},width:"10%"},{title:"创建时间",dataIndex:"gmt_create",sorter:!0},{title:"loading",dataIndex:"loading",value:!1,visible:!1},{title:"更新时间",dataIndex:"gmt_modify",sorter:!0,visible:!1},{title:"操作",dataIndex:"action",width:"160px",scopedSlots:{customRender:"action"}}],ne={name:"DeviceList",components:{STable:d["k"],Ellipsis:d["c"],DeviceInfoForm:y,DiscoveryDeviceTable:$,DiscoveryDeviceAdvancedTable:K,DeviceAudioChannelEditForm:W,DeviceAudioSetForm:te},data:function(){var e=this;return this.columns=ae,{data:[],visible:!1,edit_visible:!1,discovery_form_visible:!1,channel_visible:!1,audio_set_visible:!1,discovery_loading:!1,channelConfirmLoading:!1,audioSettingConfirmLoading:!1,discovery_device_list:[],confirmLoading:!1,mdl:null,channel_mdl:null,audio_set_mdl:null,record:null,advanced:!1,queryParam:{},groupOptions:[],loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(l["l"])(a).then((function(t){return e.data=t.data,t}))},selectedRowKeys:[],selectedRows:[]}},filters:{},created:function(){var e=this;Object(l["k"])().then((function(t){e.groupOptions=t.data}))},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleAdd:function(){this.mdl={},this.visible=!0},handleDiscovery:function(){this.discovery_form_visible=!0},handleEdit:function(e){this.visible=!0,this.mdl=Object(r["a"])({},e),this.options=this.groupOptions},handleAudioChannelEdit:function(e){var t=this;this.channel_visible=!0;var a={device_id:e};new Promise((function(e,n){Object(l["h"])(a).then((function(e){200===e.code&&(t.channel_mdl=e.result)})).catch((function(e){t.loading=!1,n(e)}))})).then()},batchOpenAudio:function(){for(var e=this,t=[],a=0;a<this.selectedRows.length;a++){var n=this.selectedRows[a];0!==n.status&&t.push(n.id)}var i={device_ids:t};this.loading=!0,new Promise((function(t,a){Object(c["c"])(i).then((function(t){200===t.code?(e.$message.info(t.message),e.$refs.table.refresh()):(e.loading=!1,e.$message.error(t.message))})).catch((function(t){a(t),e.$message.error("请求失败"),e.loading=!1}))})).then()},batchCloseAudio:function(){for(var e=this,t=[],a=0;a<this.selectedRows.length;a++){var n=this.selectedRows[a];0!==n.status&&t.push(n.id)}this.loading=!0;var i={device_ids:t};new Promise((function(t,a){Object(c["a"])(i).then((function(t){200===t.code?(e.$message.info(t.message),e.$refs.table.refresh()):(e.loading=!1,e.$message.error(t.message))})).catch((function(t){a(t),e.loading=!1,e.$message.error("请求失败")}))})).then()},handleAudioSet:function(e){var t=this;this.audio_set_visible=!0;var a={device_id:e};new Promise((function(e,n){Object(l["i"])(a).then((function(e){200===e.code&&(t.audio_set_mdl=e.result)})).catch((function(e){t.loading=!1,n(e)}))})).then()},delete_device:function(e){var t=this;this.loading=!0,new Promise((function(a,n){Object(l["c"])(e).then((function(e){200===e.code&&(t.$message.info(e.message),t.$refs.table.refresh())})).catch((function(e){t.loading=!1,n(e)}))})).then()},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(a,n){a?e.confirmLoading=!1:new Promise((function(a,i){n.id>0?Object(l["f"])(n).then((function(a){200===a.code&&(e.$message.info(a.message),t.resetFields(),e.visible=!1,e.confirmLoading=!1,e.$refs.table.refresh())})).catch((function(t){e.confirmLoading=!1,i(t)})):Object(l["a"])(n).then((function(a){200===a.code?(e.$message.info(a.message),t.resetFields(),e.visible=!1,e.confirmLoading=!1,e.$refs.table.refresh()):(e.$message.error(a.message),e.confirmLoading=!1)})).catch((function(t){e.confirmLoading=!1,e.$message.error("请求失败"),i(t)}))})).then()}))},handleChannelOk:function(){var e=this,t=this.$refs.deviceAudioChannelModal.form;this.channelConfirmLoading=!0,t.validateFields((function(a,n){a?e.channelConfirmLoading=!1:n.id>0&&new Promise((function(a,i){Object(l["n"])(n).then((function(a){200===a.code?(e.$message.info(a.message),t.resetFields(),e.channel_visible=!1,e.channelConfirmLoading=!1,e.$refs.table.refresh()):e.$message.error(a.message)})).catch((function(t){e.channelConfirmLoading=!1,i(t)}))})).then()}))},handleAudioSettingOk:function(){var e=this,t=this.$refs.deviceAudioSetModal.form;this.audioSettingConfirmLoading=!0,t.validateFields((function(a,n){a?e.audioSettingConfirmLoading=!1:n.id>0&&new Promise((function(a,i){Object(l["o"])(n).then((function(a){200===a.code?(e.$message.info(a.message),t.resetFields(),e.channel_visible=!1,e.audioSettingConfirmLoading=!1,e.$refs.table.refresh()):e.$message.error(a.message)})).catch((function(t){e.audioSettingConfirmLoading=!1,i(t)}))})).then()}))},handleCancel:function(){this.visible=!1;var e=this.$refs.createModal.form;e.resetFields()},handleEditCancel:function(){this.edit_visible=!1;var e=this.$refs.editModal.form;e.resetFields()},handleDiscoveryCancel:function(){this.discovery_form_visible=!1,this.discovery_loading=!1,this.discovery_device_list=[]},handleChannelCancel:function(){this.channel_visible=!1},handleAudioSettingCancel:function(){this.audio_set_visible=!1},handleAudioRecord:function(e,t){var a=this,n=this.data.find((function(e){return e.id===t}));n._originalData=Object(r["a"])({},n),n.loading=!0;var i={device_id:t};new Promise((function(e,t){1===n.status?Object(c["c"])(i).then((function(e){200===e.code?(n.status=2,n.loading=!1,a.$message.info(e.message)):(n.loading=!1,a.$message.error(e.message))})).catch((function(e){t(e),n.loading=!1,a.$message.error("请求失败")})):Object(c["a"])(i).then((function(e){200===e.code?(n.status=1,n.loading=!1,a.$message.info(e.message)):(n.loading=!1,a.$message.error(e.message))})).catch((function(e){t(e),n.loading=!1,a.$message.error("请求失败")}))})).then()},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:s()(new Date)}}}},ie=ne,re=Object(g["a"])(ie,n,i,!1,null,null,null);t["default"]=re.exports},"88bc":function(e,t,a){(function(t){var a=1/0,n=9007199254740991,i="[object Arguments]",r="[object Function]",o="[object GeneratorFunction]",s="[object Symbol]",d="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,c=d||l||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,n=e?e.length:0,i=Array(n);while(++a<n)i[a]=t(e[a],a,e);return i}function f(e,t){var a=-1,n=t.length,i=e.length;while(++a<n)e[i+a]=t[a];return e}var v=Object.prototype,p=v.hasOwnProperty,h=v.toString,b=c.Symbol,g=v.propertyIsEnumerable,_=b?b.isConcatSpreadable:void 0,y=Math.max;function w(e,t,a,n,i){var r=-1,o=e.length;a||(a=j),i||(i=[]);while(++r<o){var s=e[r];t>0&&a(s)?t>1?w(s,t-1,a,n,i):f(i,s):n||(i[i.length]=s)}return i}function k(e,t){return e=Object(e),O(e,t,(function(t,a){return a in e}))}function O(e,t,a){var n=-1,i=t.length,r={};while(++n<i){var o=t[n],s=e[o];a(s,o)&&(r[o]=s)}return r}function x(e,t){return t=y(void 0===t?e.length-1:t,0),function(){var a=arguments,n=-1,i=y(a.length-t,0),r=Array(i);while(++n<i)r[n]=a[t+n];n=-1;var o=Array(t+1);while(++n<t)o[n]=a[n];return o[t]=r,u(e,this,o)}}function j(e){return C(e)||$(e)||!!(_&&e&&e[_])}function S(e){if("string"==typeof e||P(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function $(e){return D(e)&&p.call(e,"callee")&&(!g.call(e,"callee")||h.call(e)==i)}var C=Array.isArray;function q(e){return null!=e&&A(e.length)&&!I(e)}function D(e){return L(e)&&q(e)}function I(e){var t=F(e)?h.call(e):"";return t==r||t==o}function A(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function L(e){return!!e&&"object"==typeof e}function P(e){return"symbol"==typeof e||L(e)&&h.call(e)==s}var R=x((function(e,t){return null==e?{}:k(e,m(w(t,1),S))}));e.exports=R}).call(this,a("c8ba"))},"909a":function(e,t,a){},aa98:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return d})),a.d(t,"l",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"g",(function(){return f})),a.d(t,"d",(function(){return v})),a.d(t,"k",(function(){return p})),a.d(t,"m",(function(){return h})),a.d(t,"h",(function(){return b})),a.d(t,"n",(function(){return g})),a.d(t,"i",(function(){return _})),a.d(t,"o",(function(){return y}));var n=a("b775"),i={create:"/api/device",edit:"/api/device",delete:"/api/device",device_list:"/api/device/list",option:"/api/device/option",device_discovery:"/api/device/discovery",audio_channel_info:"/api/device/audio/channel",audio_set:"/api/device/audio"},r={option:"/api/device/group/option",create:"/api/device/group",edit:"/api/device/group",delete:"/api/device/group",query:"/api/device/group/list"};function o(e){return Object(n["b"])({url:i.create,method:"post",data:e})}function s(e){return Object(n["b"])({url:i.edit,method:"put",data:e})}function d(e){return Object(n["b"])({url:i.delete,method:"delete",data:e})}function l(e){return Object(n["b"])({url:i.device_list,method:"get",params:e})}function c(e){return Object(n["b"])({url:i.device_discovery,method:"get",params:e})}function u(e){return Object(n["b"])({url:r.query,method:"get",params:e})}function m(e){return Object(n["b"])({url:r.create,method:"post",data:e})}function f(e){return Object(n["b"])({url:r.edit,method:"put",data:e})}function v(e){return Object(n["b"])({url:r.delete,method:"delete",data:e})}function p(e){return Object(n["b"])({url:r.option,method:"get",params:e})}function h(e){return Object(n["b"])({url:i.option,method:"get",params:e})}function b(e){return Object(n["b"])({url:i.audio_channel_info,method:"get",params:e})}function g(e){return Object(n["b"])({url:i.audio_channel_info,method:"put",data:e})}function _(e){return Object(n["b"])({url:i.audio_set,method:"get",params:e})}function y(e){return Object(n["b"])({url:i.audio_set,method:"put",data:e})}},dfe3:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return l}));var n=a("b775"),i={edit:"/api/audio",delete:"/api/audio",open:"/api/audio/channel/open",close:"/api/audio/channel/close",audio_list:"/api/audio/list",play:"/api/audio/play"};function r(e){return Object(n["b"])({url:i.edit,method:"put",data:e})}function o(e){return Object(n["b"])({url:i.delete,method:"delete",data:e})}function s(e){return Object(n["b"])({url:i.audio_list,method:"get",params:e})}function d(e){return Object(n["b"])({url:i.open,method:"post",data:e})}function l(e){return Object(n["b"])({url:i.close,method:"post",data:e})}function c(e){return Object(n["b"])({url:i.play,method:"get",params:e,responseType:"arraybuffer"})}t["b"]={audioApi:i,editAudio:r,openAudio:d,closeAudio:l,getAudioList:s,deleteAudio:o,playAudio:c}}}]);